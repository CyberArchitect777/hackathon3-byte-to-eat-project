<!-- User Review Dashboard Template-->


{% extends "base.html" %}
{% load custom_filters %}
{% block content %}

<!-- Allows User to sort through all their Takeaway ratings -->

<!-- Sorting Form -->
<form method="get" class="mb-4">
    <div class="row">
        <h2> Sort by: </h2>
        <div class="col">

            <!-- Options user can sort by -->
            <select name="sort_by" class="form-control dropdown-arrow ">
                <option value="takeaway_name" {% if request.GET.sort_by == "takeaway_name" %}selected{% endif %}>
                    Takeaway Name</option>
                <option value="food_type" {% if request.GET.sort_by == "food_type" %}selected{% endif %}>Food Type
                </option>
                <option value="rating" {% if request.GET.sort_by == "rating" %}selected{% endif %}>Rating</option>
                <option value="created_on" {% if request.GET.sort_by == "created_on" %}selected{% endif %}>Date
                </option>
                <!-- Add more sorting options here as needed -->
            </select>
        </div>

        <!-- Option to sort list by ascending or descending -->
        <div class="col">
            <select name="sort_order" class="form-control dropdown-arrow ">
                <option value="asc" {% if request.GET.sort_order == 'asc' %}selected{% endif %}>Ascending</option>
                <option value="desc" {% if request.GET.sort_order == 'desc' %}selected{% endif %}>Descending</option>
            </select>
        </div>

        <!-- Sort button -->
        <div class="col">
            <button type="submit" class="btn btn-primary">Sort</button>
        </div>

    </div>
</form>


<!-- Displays user's takeaway reviews in an easy to read table-->
<div class="container mt-4">
    <h1 class="text-center">My Takeaway Reviews</h1>
    {% if user_reviews %}
    <!-- Change to name of model-->
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Review Date</th>
                <th>Takeaway Name</th>
                <th>Food Type</th>
                <th>Rating</th>
                <th>Title</th>
                <th>Notes</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for review in user_reviews %}
            <tr>
                <td>{{ review.created_on }}</td>
                <td>{{ review.takeaway_name }}</td>
                <td>{{ review.food_type }}</td>
                <td>{{ review.rating|star_rating|safe }}</td>
                <td>{{ review.review_title }}</td>
                <td>{{ review.review_content }}</td>
                <td class="set-vertical-align">
                    <a href="{% url 'edit_review' review.pk %}" class="btn btn-primary btn-sm d-flex justify-content-center">Edit</a>
                    <a href="{% url 'delete_review' review.pk %}" class="btn btn-danger btn-sm d-flex justify-content-center">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <!-- If there are no reviews, this message will display instead -->
    {% else %}
    <p class="text-center">No reviews found. <br> Add your Takeaway reviews by clicking the button below.</p>
    {% endif %}

    <!-- Add a Review Button -->
    <div class="text-center">
       <a href="{% url 'add_review' %}" class="btn signingbutton">Add a Review</a> 
    </div>
</div>
{% endblock %}